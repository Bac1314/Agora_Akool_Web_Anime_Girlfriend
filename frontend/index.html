<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ãƒãƒ¼ãƒãƒ£ãƒ«å½¼å¥³ - Virtual Girlfriend</title>
    <link rel="stylesheet" href="styles/main.css">
    <script src="/lib/agora-rtc-sdk-ng/AgoraRTC_N-production.js"></script>
    <script src="/lib/agora-rtm/agora-rtm.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Full-Screen Avatar Background -->
        <div class="avatar-fullscreen" id="avatarContainer">
            <div class="avatar-placeholder" id="avatarPlaceholder">
                <div class="loader"></div>
                <p data-i18n="avatarLoading">Click 'Start Call' to connect</p>
            </div>
            <div class="avatar-video" id="avatarVideo" style="display: none;"></div>
        </div>

        <!-- User Camera Preview (Top Left) -->
        <div class="user-camera-preview" id="userCameraPreview" style="display: none;">
            <div class="camera-video" id="userCameraVideo"></div>
            <div class="camera-label" data-i18n="you">You</div>
        </div>

        <!-- Top Status Bar -->
        <div class="status-overlay">
            <div class="status-left">
<div class="app-title" data-i18n="title">Virtual Girlfriend</div>
            </div>
            <div class="status-right">
                <div class="status-item" id="connectionStatus">
                    <span class="status-dot offline"></span>
                </div>
                <button class="btn-icon" id="languageBtn" title="Language">
                    ğŸŒ
                </button>
                <button class="btn-icon" id="settingsBtn" title="Settings">
                    âš™
                </button>
            </div>
        </div>

        <!-- Chat Overlay (Bottom) -->
        <div class="chat-overlay" id="chatOverlay">
            <!-- Chat Toggle Button -->
            <button class="chat-toggle" id="chatToggle">
                <span class="chat-icon">ğŸ’¬</span>
<span class="chat-text" data-i18n="chat">ãƒãƒ£ãƒƒãƒˆ</span>
            </button>

            <!-- Chat Panel -->
            <div class="chat-panel" id="chatPanel">
                <div class="chat-header">
<div class="chat-title" data-i18n="chat">ãƒãƒ£ãƒƒãƒˆ</div>
                    <div class="chat-actions">
<button class="btn-mini" id="clearChatBtn" data-i18n="clear">ã‚¯ãƒªã‚¢</button>
                        <button class="btn-mini" id="closeChatBtn">Ã—</button>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="message system">
                        <div class="message-content">
<p data-i18n="welcomeMessage">Hello! I'm your girlfriend â™ª How are you today?</p>
                        </div>
                    </div>
                </div>

                <div class="chat-input-container">
                    <div class="input-group">
                        <input 
                            type="text" 
                            id="messageInput" 
data-i18n="messagePlaceholder"
                            placeholder="Type your message... â™ª" 
                            disabled
                        >
                        <button class="btn-send" id="sendBtn" disabled>
                            â†’
                        </button>
                    </div>
                    <div class="typing-indicator" id="typingIndicator" style="display: none;">
<span data-i18n="responding">She is thinking of a response...</span>
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Control Bar (Bottom Center) -->
        <div class="control-bar">
            <button class="btn-control btn-call" id="callBtn" data-state="start">
                <div class="control-icon" id="callIcon">
                    <img src="/src/assets/call.svg" alt="Start Call" class="icon-svg" id="callIconImg">
                </div>
                <div class="control-text" id="callText" data-i18n="startCall">Start Call</div>
            </button>
            <button class="btn-control btn-mute" id="muteBtn" disabled>
                <div class="control-icon" id="muteIcon">
                    <img src="/src/assets/microphone.svg" alt="Mute Audio" class="icon-svg">
                    <div class="mute-overlay" id="muteOverlay" style="display: none;"></div>
                </div>
            </button>
            <button class="btn-control btn-video-mute" id="videoMuteBtn" disabled>
                <div class="control-icon" id="videoMuteIcon">
                    <img src="/src/assets/webcam.svg" alt="Mute Video" class="icon-svg">
                    <div class="mute-overlay" id="videoMuteOverlay" style="display: none;"></div>
                </div>
            </button>
        </div>

        <!-- Settings Modal -->
        <div class="modal-overlay" id="settingsModal" style="display: none;">
            <div class="modal">
                <div class="modal-header">
<h2 data-i18n="settings">Settings</h2>
                    <button class="btn-close" id="closeSettingsBtn">Ã—</button>
                </div>
                <div class="modal-body">
                    <div class="setting-group">
<label for="channelName" data-i18n="roomName">Room Name:</label>
                        <input type="text" id="channelName" value="virtual-girlfriend-room">
                    </div>
                    <div class="setting-group">
<label for="userName" data-i18n="yourName">Your Name:</label>
                        <input type="text" id="userName" value="User" data-i18n="namePlaceholder" placeholder="Enter your name">
                    </div>
                    <div class="setting-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enableVoice" checked>
                            <span class="checkmark"></span>
<span data-i18n="enableVoice">Enable Voice Chat</span>
                        </label>
                    </div>
                    <div class="setting-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enableAvatar" checked>
                            <span class="checkmark"></span>
<span data-i18n="enableVideo">Enable Video Call</span>
                        </label>
                    </div>
                    <div class="setting-group">
                        <label for="languageSelect" data-i18n="language">è¨€èª:</label>
                        <select id="languageSelect" class="language-select">
                            <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                            <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                            <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                            <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
<button class="btn btn-secondary" id="cancelSettingsBtn" data-i18n="cancel">Cancel</button>
                    <button class="btn btn-primary" id="saveSettingsBtn" data-i18n="save">Save</button>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loadingOverlay" style="display: none;">
            <div class="loading-content">
                <div class="loader"></div>
                <p data-i18n="connecting">Connecting to your girlfriend...</p>
            </div>
        </div>
        
        <!-- Language Selector Modal -->
        <div class="modal-overlay" id="languageModal" style="display: none;">
            <div class="modal language-modal">
                <div class="modal-header">
                    <h2 data-i18n="language">Language</h2>
                    <button class="btn-close" id="closeLanguageBtn">Ã—</button>
                </div>
                <div class="modal-body">
                    <div class="language-options">
                        <div class="language-option" data-lang="ja">
                            <span class="flag">ğŸ‡¯ğŸ‡µ</span>
                            <span class="name">æ—¥æœ¬èª</span>
                        </div>
                        <div class="language-option" data-lang="en">
                            <span class="flag">ğŸ‡ºğŸ‡¸</span>
                            <span class="name">English</span>
                        </div>
                        <div class="language-option" data-lang="ko">
                            <span class="flag">ğŸ‡°ğŸ‡·</span>
                            <span class="name">í•œêµ­ì–´</span>
                        </div>
                        <div class="language-option" data-lang="zh">
                            <span class="flag">ğŸ‡¨ğŸ‡³</span>
                            <span class="name">ä¸­æ–‡</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Conversation Summary Modal -->
        <div class="modal-overlay" id="summaryModal" style="display: none;">
            <div class="modal summary-modal">
                <div class="modal-header">
                    <h2 data-i18n="conversationSummary">Conversation Summary</h2>
                    <button class="btn-close" id="closeSummaryBtn">Ã—</button>
                </div>
                <div class="modal-body">
                    <div class="summary-loading" id="summaryLoading" style="display: none;">
                        <div class="loader"></div>
                        <p data-i18n="analyzingConversation">Analyzing your conversation...</p>
                    </div>
                    <div class="summary-content" id="summaryContent" style="display: none;">
                        <div class="rating-section">
                            <div class="rating-label" data-i18n="yourRating">Your Conversation Rating</div>
                            <div class="star-rating" id="starRating">
                                <span class="star">â˜…</span>
                                <span class="star">â˜…</span>
                                <span class="star">â˜…</span>
                                <span class="star">â˜…</span>
                                <span class="star">â˜…</span>
                            </div>
                            <div class="rating-description" id="ratingDescription">
                                Average - Decent conversation, polite but basic interaction
                            </div>
                        </div>
                        <div class="summary-section">
                            <div class="summary-label" data-i18n="summary">Summary</div>
                            <div class="summary-text" id="summaryText">
                                Your conversation summary will appear here...
                            </div>
                        </div>
                    </div>
                    <div class="summary-error" id="summaryError" style="display: none;">
                        <p>Failed to generate summary. Please try again.</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" id="closeSummaryDoneBtn" data-i18n="done">Done</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Debug Info -->
    <div class="debug-info" id="debugInfo" style="display: none;">
        <div class="debug-item">
            <span class="debug-label">Channel:</span>
            <span class="debug-value" id="debugChannel">-</span>
        </div>
        <div class="debug-item">
            <span class="debug-label">User:</span>
            <span class="debug-value" id="debugUser">-</span>
        </div>
        <div class="debug-item">
            <span class="debug-label">Agent:</span>
            <span class="debug-value" id="debugAgent">-</span>
        </div>
    </div>

    <script src="utils/i18n.js"></script>
    <script src="utils/config.js"></script>
    <script src="utils/agoraManager.js"></script>
    <script src="utils/avatarManager.js"></script>
    <script src="components/chat.js"></script>
    <script src="components/controls.js"></script>
    <script src="components/language.js"></script>
    <script src="main.js"></script>
</body>
</html>